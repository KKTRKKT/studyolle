<html xmlns:th="https://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:replace="~{fragments/settingsLayout :: base (~{::body}, ~{::alert}, ~{::scripts})}">

<alert>
    <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert" >
        <span>닉네임을 성공적으로 변경했습니다!</span>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
</alert>

<body>
<div class="row">
    <h2 class="col-sm-12">닉네임 변경</h2>
    <div class="border-top"></div>
</div>
<div class="row mt-3">
    <div class="col-sm-12">
        <form class="needs-validation" th:action="@{/settings/nickname}" th:object="${nicknameUpdateForm}" method="post" novalidate>
            <div class="alert alert-warning mb-3" role="alert" >
                <span>닉네임을 변경하면 프로필 페이지 링크도 바뀝니다!</span>
            </div>
            <div class="form-group">
                <input id="nickname" type="text"  class="form-control" th:field="*{nickname}"
                       aria-describedby="nicknameHelp" required minlength="3" maxlength="20">
                <small id="nicknameHelp" class="form-text text-muted">
                    공백없이 문자와 숫자로만 3자 이상 20자 이내로 입력하세요.
                </small>
                <small class="invalid-feedback">닉네임을 입력하세요.</small>
                <small class="form-text text-danger" th:if="${#fields.hasErrors('nickname')}" th:errors="*{nickname}">Nickname Error</small>
            </div>

            <div class="form-group mt-3">
                <button type="submit" class="btn btn-outline-primary">변경하기</button>
            </div>
        </form>
    </div>
</div>
<div class="row">
    <h2 class="col-sm-12 text-danger">계정 삭제</h2>
    <div class="border-top"></div>
</div>
<div class="row mt-3">
    <div class="col-sm-12">
        <div class="alert alert-danger mb-3" role="alert" >
            <span>이 계정은 삭제할 수 없습니다!</span>
        </div>
        <button type="submit" class="btn btn-outline-danger disabled">삭제</button>
    </div>
</div>
</body>

<scripts>
    <script type="application/javascript">

        $(function(){
            $("#passwordForm").submit((event) => {
                const password = document.getElementById("password").value;
                const confirmPassword = document.getElementById("confirmPassword").value;

                if (password !== confirmPassword) {
                    $("#passwordMismatch").removeClass("d-none");
                    event.preventDefault();
                    event.stopPropagation();
                }
            })
        })
    </script>
</scripts>
</html>